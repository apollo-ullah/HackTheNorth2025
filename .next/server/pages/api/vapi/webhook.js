"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/vapi/webhook";
exports.ids = ["pages/api/vapi/webhook"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "openai":
/*!*************************!*\
  !*** external "openai" ***!
  \*************************/
/***/ ((module) => {

module.exports = import("openai");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fvapi%2Fwebhook&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fvapi%2Fwebhook.ts&middlewareConfigBase64=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fvapi%2Fwebhook&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fvapi%2Fwebhook.ts&middlewareConfigBase64=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_vapi_webhook_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/vapi/webhook.ts */ \"(api)/./pages/api/vapi/webhook.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_vapi_webhook_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_vapi_webhook_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_vapi_webhook_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_vapi_webhook_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/vapi/webhook\",\n        pathname: \"/api/vapi/webhook\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_vapi_webhook_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnZhcGklMkZ3ZWJob29rJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlMkZhcGklMkZ2YXBpJTJGd2ViaG9vay50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUN3RDtBQUN4RDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsdURBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHVEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCxxQyIsInNvdXJjZXMiOlsid2VicGFjazovL3N0YWN5LWFpLXNhZmV0eS1jb21wYW5pb24vP2I5OTMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzL2FwaS92YXBpL3dlYmhvb2sudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS92YXBpL3dlYmhvb2tcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS92YXBpL3dlYmhvb2tcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fvapi%2Fwebhook&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fvapi%2Fwebhook.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/vapi/webhook.ts":
/*!***********************************!*\
  !*** ./pages/api/vapi/webhook.ts ***!
  \***********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! openai */ \"openai\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([openai__WEBPACK_IMPORTED_MODULE_0__]);\nopenai__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\nasync function sendSms(phone, message) {\n    try {\n        const accountSid = process.env.TWILIO_ACCOUNT_SID;\n        const authToken = process.env.TWILIO_AUTH_TOKEN;\n        const fromNumber = process.env.TWILIO_NUMBER;\n        if (!accountSid || !authToken || !fromNumber) return {\n            success: false,\n            error: \"Twilio not configured\"\n        };\n        const basic = Buffer.from(`${accountSid}:${authToken}`).toString(\"base64\");\n        const body = new URLSearchParams({\n            From: fromNumber,\n            To: phone,\n            Body: message\n        });\n        const resp = await fetch(`https://api.twilio.com/2010-04-01/Accounts/${accountSid}/Messages.json`, {\n            method: \"POST\",\n            headers: {\n                Authorization: `Basic ${basic}`,\n                \"Content-Type\": \"application/x-www-form-urlencoded\"\n            },\n            body\n        });\n        const data = await resp.json();\n        if (!resp.ok) return {\n            success: false,\n            error: data?.message || \"Twilio SMS failed\"\n        };\n        return {\n            success: true,\n            sid: data.sid\n        };\n    } catch (e) {\n        return {\n            success: false,\n            error: e?.message || \"SMS error\"\n        };\n    }\n}\nasync function createEmergencyConference(script, userPhone, lat, lng) {\n    const accountSid = process.env.TWILIO_ACCOUNT_SID;\n    const authToken = process.env.TWILIO_AUTH_TOKEN;\n    const fromNumber = process.env.TWILIO_NUMBER;\n    const dispatchNumber = process.env.DEMO_EMERGENCY_NUMBER || \"+14383761217\";\n    if (!accountSid || !authToken || !fromNumber) {\n        return {\n            success: false,\n            error: \"Twilio not configured\"\n        };\n    }\n    const basic = Buffer.from(`${accountSid}:${authToken}`).toString(\"base64\");\n    const conferenceId = `emergency-${Date.now()}`;\n    console.log(\"\\uD83C\\uDFAF Creating 3-way emergency conference:\", conferenceId);\n    console.log(\"\\uD83C\\uDFAF Connecting user:\", userPhone, \"and dispatch:\", dispatchNumber);\n    try {\n        // 1. Call the user and put them in conference\n        const userTwiml = `<Response>\n      <Say voice=\"alice\">You are being connected to emergency dispatch. Please hold.</Say>\n      <Dial>\n        <Conference waitMusic=\"false\" waitUrl=\"\">${conferenceId}</Conference>\n      </Dial>\n    </Response>`;\n        const userBody = new URLSearchParams({\n            From: fromNumber,\n            To: userPhone,\n            Twiml: userTwiml\n        });\n        const userCall = await fetch(`https://api.twilio.com/2010-04-01/Accounts/${accountSid}/Calls.json`, {\n            method: \"POST\",\n            headers: {\n                Authorization: `Basic ${basic}`,\n                \"Content-Type\": \"application/x-www-form-urlencoded\"\n            },\n            body: userBody\n        });\n        // 2. Call dispatch and put them in the same conference\n        const dispatchTwiml = `<Response>\n      <Say voice=\"alice\" rate=\"slow\">\n        This is Stacy AI emergency dispatch system. \n        ${script}\n        ${lat && lng ? `The caller's location is approximately latitude ${lat}, longitude ${lng}.` : \"Location data is not available.\"}\n        Connecting you to the emergency caller now.\n      </Say>\n      <Dial>\n        <Conference waitMusic=\"false\" waitUrl=\"\">${conferenceId}</Conference>\n      </Dial>\n    </Response>`;\n        const dispatchBody = new URLSearchParams({\n            From: fromNumber,\n            To: dispatchNumber,\n            Twiml: dispatchTwiml\n        });\n        const dispatchCall = await fetch(`https://api.twilio.com/2010-04-01/Accounts/${accountSid}/Calls.json`, {\n            method: \"POST\",\n            headers: {\n                Authorization: `Basic ${basic}`,\n                \"Content-Type\": \"application/x-www-form-urlencoded\"\n            },\n            body: dispatchBody\n        });\n        const userResult = await userCall.json();\n        const dispatchResult = await dispatchCall.json();\n        console.log(\"\\uD83C\\uDFAF Conference calls initiated:\", {\n            user: userResult.sid,\n            dispatch: dispatchResult.sid,\n            conference: conferenceId\n        });\n        return {\n            success: true,\n            conferenceId,\n            userCallSid: userResult.sid,\n            dispatchCallSid: dispatchResult.sid,\n            message: \"Emergency conference created - all parties will be connected\"\n        };\n    } catch (error) {\n        console.error(\"\\uD83D\\uDEA8 Conference creation failed:\", error);\n        return {\n            success: false,\n            error: error?.message || \"Conference creation failed\"\n        };\n    }\n}\n// Basic in-memory de-dupe so we don't double-trigger actions per call\nconst triggeredByCallId = new Map();\nfunction wasTriggered(callId, action) {\n    if (!callId) return false;\n    const set = triggeredByCallId.get(callId) || new Set();\n    const had = set.has(action);\n    set.add(action);\n    triggeredByCallId.set(callId, set);\n    return had;\n}\n// 🧠 OpenAI BRAIN - Handles ALL thinking, responses, and tool calling\nasync function processWithOpenAIBrain(callId, conversation, lat, lng) {\n    try {\n        console.log(\"\\uD83E\\uDDE0 OpenAI BRAIN processing conversation for call:\", callId);\n        // Rate limiting - don't process the same conversation multiple times\n        const conversationHash = JSON.stringify(conversation);\n        const lastProcessedKey = `${callId}:last_processed`;\n        const lastProcessed = triggeredByCallId.get(lastProcessedKey);\n        if (lastProcessed && lastProcessed.has(conversationHash)) {\n            console.log(\"\\uD83E\\uDDE0 OpenAI BRAIN: Already processed this conversation, skipping\");\n            return {\n                response: null\n            };\n        }\n        // Mark this conversation as processed\n        const processedSet = lastProcessed || new Set();\n        processedSet.add(conversationHash);\n        triggeredByCallId.set(lastProcessedKey, processedSet);\n        const openaiApiKey = process.env.OPENAI_API_KEY;\n        if (!openaiApiKey) {\n            console.warn(\"⚠️ OpenAI API key not configured\");\n            return {\n                response: \"I'm having trouble connecting to my brain. Please try again.\"\n            };\n        }\n        const openai = new openai__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\n            apiKey: openaiApiKey\n        });\n        // Get conversation history\n        const messages = conversation.map((msg)=>({\n                role: msg.role === \"user\" ? \"user\" : \"assistant\",\n                content: msg.content || msg.message || \"\"\n            }));\n        // Add Stacy's system prompt\n        const systemPrompt = `You are Stacy, an AI safety companion and emergency dispatcher.\n\nCONTEXT:\n- This is a voice call via VAPI (you are the brain, VAPI is just voice I/O)\n- Location: ${lat && lng ? `${lat}, ${lng}` : \"Unknown\"}\n- Call ID: ${callId}\n\nTOOLS AVAILABLE:\n- call_demo_police: Call demo dispatcher at +14383761217\n- send_contact_sms: Send SMS to emergency contact +15146605707  \n- transfer_call: Transfer user to emergency services\n- get_safe_locations: Get nearby safe locations\n\nINSTRUCTIONS:\n- Be warm, professional, and supportive\n- Ask assessment questions to understand the situation\n- Use tools when appropriate (emergency dispatch, SMS alerts, etc.)\n- Keep responses concise for voice calls\n- Take immediate action for emergencies\n- Remember: YOU control everything, VAPI just does voice I/O\n\nRespond naturally as Stacy would, and use function calls when needed.`;\n        const completion = await openai.chat.completions.create({\n            model: \"gpt-4o-mini\",\n            messages: [\n                {\n                    role: \"system\",\n                    content: systemPrompt\n                },\n                ...messages\n            ],\n            functions: [\n                {\n                    name: \"call_demo_police\",\n                    description: \"Call emergency dispatch with briefing\",\n                    parameters: {\n                        type: \"object\",\n                        properties: {\n                            script: {\n                                type: \"string\",\n                                description: \"Briefing for dispatch\"\n                            },\n                            lat: {\n                                type: \"number\",\n                                description: \"Latitude\"\n                            },\n                            lng: {\n                                type: \"number\",\n                                description: \"Longitude\"\n                            }\n                        },\n                        required: [\n                            \"script\"\n                        ]\n                    }\n                },\n                {\n                    name: \"send_contact_sms\",\n                    description: \"Send SMS to emergency contact\",\n                    parameters: {\n                        type: \"object\",\n                        properties: {\n                            phone: {\n                                type: \"string\",\n                                description: \"Phone number\"\n                            },\n                            message: {\n                                type: \"string\",\n                                description: \"SMS message\"\n                            },\n                            urgent: {\n                                type: \"boolean\",\n                                description: \"Is urgent\"\n                            }\n                        },\n                        required: [\n                            \"message\"\n                        ]\n                    }\n                },\n                {\n                    name: \"transfer_call\",\n                    description: \"Transfer call to emergency services\",\n                    parameters: {\n                        type: \"object\",\n                        properties: {\n                            destination: {\n                                type: \"string\",\n                                description: \"Phone number to transfer to\"\n                            },\n                            message: {\n                                type: \"string\",\n                                description: \"Transfer message\"\n                            }\n                        },\n                        required: [\n                            \"destination\"\n                        ]\n                    }\n                }\n            ],\n            function_call: \"auto\",\n            temperature: 0.7,\n            max_tokens: 300\n        });\n        const response = completion.choices[0]?.message;\n        console.log(\"\\uD83E\\uDDE0 OpenAI BRAIN response:\", response);\n        // Handle function calls\n        if (response?.function_call) {\n            const functionName = response.function_call.name;\n            const functionArgs = JSON.parse(response.function_call.arguments || \"{}\");\n            console.log(\"\\uD83E\\uDDE0 OpenAI BRAIN wants to call function:\", functionName, functionArgs);\n            let functionResult = null;\n            // Prevent double calling - check if already triggered for this call\n            if (functionName === \"call_demo_police\" && wasTriggered(callId, \"emergency_conference\")) {\n                console.log(\"\\uD83D\\uDEA8 Emergency conference already created for this call, skipping\");\n                functionResult = {\n                    success: true,\n                    message: \"Emergency response already in progress\"\n                };\n            } else {\n                switch(functionName){\n                    case \"call_demo_police\":\n                        // Use the new 3-way conference system\n                        const userPhone = process.env.DEMO_USER_NUMBER || \"+15146605707\"; // Your phone number\n                        functionResult = await createEmergencyConference(functionArgs.script, userPhone, functionArgs.lat || lat, functionArgs.lng || lng);\n                        // Mark as triggered to prevent duplicates\n                        const set = triggeredByCallId.get(callId) || new Set();\n                        set.add(\"emergency_conference\");\n                        triggeredByCallId.set(callId, set);\n                        break;\n                    case \"send_contact_sms\":\n                        const phone = functionArgs.phone || process.env.DEMO_EMERGENCY_CONTACT || \"+15146605707\";\n                        functionResult = await sendSms(phone, functionArgs.message);\n                        break;\n                    case \"transfer_call\":\n                        functionResult = {\n                            success: true,\n                            transfer: {\n                                destination: functionArgs.destination,\n                                message: functionArgs.message || \"Transferring your call now.\"\n                            }\n                        };\n                        break;\n                }\n            }\n            console.log(\"\\uD83E\\uDDE0 Function result:\", functionResult);\n            // Generate follow-up response after function call\n            const followUpCompletion = await openai.chat.completions.create({\n                model: \"gpt-4o-mini\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: systemPrompt\n                    },\n                    ...messages,\n                    {\n                        role: \"assistant\",\n                        content: response.content || \"\",\n                        function_call: response.function_call\n                    },\n                    {\n                        role: \"function\",\n                        name: functionName,\n                        content: JSON.stringify(functionResult)\n                    }\n                ],\n                temperature: 0.7,\n                max_tokens: 200\n            });\n            return {\n                response: followUpCompletion.choices[0]?.message?.content || \"Action completed.\",\n                functionCall: {\n                    name: functionName,\n                    result: functionResult\n                },\n                transfer: functionResult?.transfer\n            };\n        }\n        return {\n            response: response?.content || \"I'm here to help. How can I assist you with your safety today?\"\n        };\n    } catch (error) {\n        console.error(\"❌ OpenAI BRAIN error:\", error);\n        return {\n            response: \"I'm having trouble processing right now. If this is an emergency, please call 911 directly.\"\n        };\n    }\n}\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            message: \"Method not allowed\"\n        });\n    }\n    try {\n        const { message } = req.body;\n        console.log(\"\\uD83D\\uDD04 VAPI Webhook received:\", message?.type);\n        // Handle different VAPI message types\n        switch(message?.type){\n            case \"function-call\":\n                console.log(\"\\uD83D\\uDEE0️ Function call:\", message.functionCall?.name);\n                try {\n                    const { name, parameters } = message.functionCall || {};\n                    if (name === \"send_contact_sms\") {\n                        const { phone, message: body, lat, lng, urgent } = parameters || {};\n                        const defaultContact = process.env.DEMO_EMERGENCY_CONTACT || \"+15146605707\";\n                        const toPhone = phone || defaultContact;\n                        const text = `${body}${lat && lng ? `\\n\\nLocation: https://maps.google.com/maps?q=${lat},${lng}` : \"\"}`;\n                        const result = await sendSms(toPhone, text);\n                        return res.json({\n                            result\n                        });\n                    }\n                    if (name === \"call_demo_police\") {\n                        const { script, lat, lng } = parameters || {};\n                        const full = `${script}${lat && lng ? ` Location coordinates ${lat}, ${lng}.` : \"\"}`;\n                        console.log(\"\\uD83D\\uDE94 VAPI calling call_demo_police - creating 3-way conference\");\n                        // Create 3-way conference call\n                        const userPhone = process.env.DEMO_USER_NUMBER || \"+15146605707\"; // Your phone\n                        const conferenceResult = await createEmergencyConference(full, userPhone, lat, lng);\n                        console.log(\"\\uD83C\\uDFAF Conference creation result:\", conferenceResult);\n                        const result = {\n                            success: conferenceResult.success,\n                            message: conferenceResult.message || \"Emergency conference created\",\n                            conferenceId: conferenceResult.conferenceId\n                        };\n                        return res.json({\n                            result\n                        });\n                    }\n                    if (name === \"transfer_to_emergency_services\") {\n                        const { destination, reason } = parameters || {};\n                        const script = `This is Stacy AI. Emergency transfer requested: ${reason}`;\n                        console.log(\"\\uD83D\\uDE94 VAPI calling transfer_to_emergency_services - creating 3-way conference\");\n                        // Create 3-way conference for emergency transfer\n                        const userPhone = process.env.DEMO_USER_NUMBER || \"+15146605707\";\n                        const conferenceResult = await createEmergencyConference(script, userPhone);\n                        console.log(\"\\uD83C\\uDFAF Emergency transfer conference result:\", conferenceResult);\n                        const result = {\n                            success: conferenceResult.success,\n                            message: conferenceResult.message || \"Emergency transfer conference created\",\n                            conferenceId: conferenceResult.conferenceId\n                        };\n                        return res.json({\n                            result\n                        });\n                    }\n                    if (name === \"get_safe_locations\") {\n                        const { lat = 43.4728, lng = -80.5419 } = parameters || {};\n                        return res.json({\n                            result: {\n                                success: true,\n                                locations: [\n                                    {\n                                        name: \"Central Police Station\",\n                                        type: \"police_station\",\n                                        lat: lat + 0.004,\n                                        lng: lng + 0.002,\n                                        distance_m: 450\n                                    },\n                                    {\n                                        name: \"City Hospital Emergency\",\n                                        type: \"hospital\",\n                                        lat: lat - 0.003,\n                                        lng: lng + 0.005,\n                                        distance_m: 680\n                                    },\n                                    {\n                                        name: \"24/7 Cafe Central\",\n                                        type: \"cafe\",\n                                        lat: lat + 0.002,\n                                        lng: lng - 0.001,\n                                        distance_m: 320\n                                    }\n                                ]\n                            }\n                        });\n                    }\n                    return res.json({\n                        result: {\n                            success: false,\n                            error: \"Unknown function\"\n                        }\n                    });\n                } catch (err) {\n                    console.error(\"Function call error:\", err);\n                    return res.json({\n                        result: {\n                            success: false,\n                            error: err?.message || \"Function error\"\n                        }\n                    });\n                }\n            case \"conversation-update\":\n                try {\n                    console.log(\"\\uD83D\\uDD04 CONVERSATION UPDATE - OpenAI BRAIN taking over!\");\n                    const callId = req.body?.message?.call?.id;\n                    const conversation = req.body?.message?.conversation || [];\n                    const metaLocation = req.body?.message?.call?.assistant?.metadata?.location;\n                    const lat = metaLocation?.lat;\n                    const lng = metaLocation?.lng;\n                    console.log(\"\\uD83D\\uDD04 Sending to OpenAI BRAIN:\", {\n                        callId,\n                        conversationLength: conversation.length\n                    });\n                    // 🧠 OpenAI BRAIN processes everything and decides what to do\n                    const brainResult = await processWithOpenAIBrain(callId, conversation, lat, lng);\n                    console.log(\"\\uD83E\\uDDE0 OpenAI BRAIN result:\", brainResult);\n                    // If OpenAI wants to transfer the call, return transfer instruction\n                    if (brainResult.transfer) {\n                        console.log(\"\\uD83D\\uDD04 OpenAI BRAIN requesting call transfer:\", brainResult.transfer);\n                        return res.json({\n                            message: {\n                                type: \"transfer-call\",\n                                destination: brainResult.transfer.destination,\n                                transferMessage: brainResult.transfer.message\n                            }\n                        });\n                    }\n                    // If OpenAI generated a response, we could send it back to VAPI\n                    // (In a full implementation, you'd send this back to VAPI to speak)\n                    if (brainResult.response) {\n                        console.log(\"\\uD83D\\uDDE3️ OpenAI BRAIN wants to say:\", brainResult.response);\n                    }\n                    // OpenAI BRAIN handles everything now - no more heuristics needed!\n                    console.log(\"\\uD83E\\uDDE0 OpenAI BRAIN is in control - skipping old heuristic triggers\");\n                } catch (err) {\n                    console.warn(\"Conversation-update analysis failed:\", err);\n                }\n                return res.json({\n                    received: true\n                });\n            case \"hang\":\n                console.log(\"\\uD83D\\uDCDE Call ended\");\n                return res.json({\n                    received: true\n                });\n            default:\n                console.log(\"ℹ️ Other message type:\", message?.type, \"- OpenAI BRAIN handles all logic now\");\n                return res.json({\n                    received: true\n                });\n        }\n    } catch (error) {\n        console.error(\"VAPI webhook error:\", error);\n        return res.status(500).json({\n            error: error instanceof Error ? error.message : \"Unknown error occurred\"\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFBMEJ6QyxTQUFTZ0csTUFBTTtnQkFDckQsT0FBT3NCLElBQUk1RixJQUFJLENBQUM7b0JBQUVpSCxVQUFVO2dCQUFLO1FBQ3JDO0lBRUYsRUFBRSxPQUFPakksT0FBTztRQUNkOEIsUUFBUTlCLEtBQUssQ0FBQyx1QkFBdUJBO1FBQ3JDLE9BQU80RyxJQUFJQyxNQUFNLENBQUMsS0FBSzdGLElBQUksQ0FBQztZQUMxQmhCLE9BQU9BLGlCQUFpQmtJLFFBQVFsSSxNQUFNVixPQUFPLEdBQUc7UUFDbEQ7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3RhY3ktYWktc2FmZXR5LWNvbXBhbmlvbi8uL3BhZ2VzL2FwaS92YXBpL3dlYmhvb2sudHM/YTNkNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XG5pbXBvcnQgT3BlbkFJIGZyb20gJ29wZW5haSc7XG5cbmFzeW5jIGZ1bmN0aW9uIHNlbmRTbXMocGhvbmU6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nKTogUHJvbWlzZTx7IHN1Y2Nlc3M6IGJvb2xlYW47IHNpZD86IHN0cmluZzsgZXJyb3I/OiBzdHJpbmcgfT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGFjY291bnRTaWQgPSBwcm9jZXNzLmVudi5UV0lMSU9fQUNDT1VOVF9TSUQ7XG4gICAgY29uc3QgYXV0aFRva2VuID0gcHJvY2Vzcy5lbnYuVFdJTElPX0FVVEhfVE9LRU47XG4gICAgY29uc3QgZnJvbU51bWJlciA9IHByb2Nlc3MuZW52LlRXSUxJT19OVU1CRVI7XG4gICAgaWYgKCFhY2NvdW50U2lkIHx8ICFhdXRoVG9rZW4gfHwgIWZyb21OdW1iZXIpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1R3aWxpbyBub3QgY29uZmlndXJlZCcgfTtcbiAgICBjb25zdCBiYXNpYyA9IEJ1ZmZlci5mcm9tKGAke2FjY291bnRTaWR9OiR7YXV0aFRva2VufWApLnRvU3RyaW5nKCdiYXNlNjQnKTtcbiAgICBjb25zdCBib2R5ID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7IEZyb206IGZyb21OdW1iZXIsIFRvOiBwaG9uZSwgQm9keTogbWVzc2FnZSB9KTtcbiAgICBjb25zdCByZXNwID0gYXdhaXQgZmV0Y2goYGh0dHBzOi8vYXBpLnR3aWxpby5jb20vMjAxMC0wNC0wMS9BY2NvdW50cy8ke2FjY291bnRTaWR9L01lc3NhZ2VzLmpzb25gLCB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHsgQXV0aG9yaXphdGlvbjogYEJhc2ljICR7YmFzaWN9YCwgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnIH0sXG4gICAgICBib2R5XG4gICAgfSk7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3AuanNvbigpO1xuICAgIGlmICghcmVzcC5vaykgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBkYXRhPy5tZXNzYWdlIHx8ICdUd2lsaW8gU01TIGZhaWxlZCcgfTtcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBzaWQ6IGRhdGEuc2lkIH07XG4gIH0gY2F0Y2ggKGU6IGFueSkge1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZT8ubWVzc2FnZSB8fCAnU01TIGVycm9yJyB9O1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUVtZXJnZW5jeUNvbmZlcmVuY2Uoc2NyaXB0OiBzdHJpbmcsIHVzZXJQaG9uZTogc3RyaW5nLCBsYXQ/OiBudW1iZXIsIGxuZz86IG51bWJlcikge1xuICBjb25zdCBhY2NvdW50U2lkID0gcHJvY2Vzcy5lbnYuVFdJTElPX0FDQ09VTlRfU0lEO1xuICBjb25zdCBhdXRoVG9rZW4gPSBwcm9jZXNzLmVudi5UV0lMSU9fQVVUSF9UT0tFTjtcbiAgY29uc3QgZnJvbU51bWJlciA9IHByb2Nlc3MuZW52LlRXSUxJT19OVU1CRVI7XG4gIGNvbnN0IGRpc3BhdGNoTnVtYmVyID0gcHJvY2Vzcy5lbnYuREVNT19FTUVSR0VOQ1lfTlVNQkVSIHx8ICcrMTQzODM3NjEyMTcnO1xuICBcbiAgaWYgKCFhY2NvdW50U2lkIHx8ICFhdXRoVG9rZW4gfHwgIWZyb21OdW1iZXIpIHtcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdUd2lsaW8gbm90IGNvbmZpZ3VyZWQnIH07XG4gIH1cbiAgXG4gIGNvbnN0IGJhc2ljID0gQnVmZmVyLmZyb20oYCR7YWNjb3VudFNpZH06JHthdXRoVG9rZW59YCkudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuICBjb25zdCBjb25mZXJlbmNlSWQgPSBgZW1lcmdlbmN5LSR7RGF0ZS5ub3coKX1gO1xuICBcbiAgY29uc29sZS5sb2coJ/Cfjq8gQ3JlYXRpbmcgMy13YXkgZW1lcmdlbmN5IGNvbmZlcmVuY2U6JywgY29uZmVyZW5jZUlkKTtcbiAgY29uc29sZS5sb2coJ/Cfjq8gQ29ubmVjdGluZyB1c2VyOicsIHVzZXJQaG9uZSwgJ2FuZCBkaXNwYXRjaDonLCBkaXNwYXRjaE51bWJlcik7XG4gIFxuICB0cnkge1xuICAgIC8vIDEuIENhbGwgdGhlIHVzZXIgYW5kIHB1dCB0aGVtIGluIGNvbmZlcmVuY2VcbiAgICBjb25zdCB1c2VyVHdpbWwgPSBgPFJlc3BvbnNlPlxuICAgICAgPFNheSB2b2ljZT1cImFsaWNlXCI+WW91IGFyZSBiZWluZyBjb25uZWN0ZWQgdG8gZW1lcmdlbmN5IGRpc3BhdGNoLiBQbGVhc2UgaG9sZC48L1NheT5cbiAgICAgIDxEaWFsPlxuICAgICAgICA8Q29uZmVyZW5jZSB3YWl0TXVzaWM9XCJmYWxzZVwiIHdhaXRVcmw9XCJcIj4ke2NvbmZlcmVuY2VJZH08L0NvbmZlcmVuY2U+XG4gICAgICA8L0RpYWw+XG4gICAgPC9SZXNwb25zZT5gO1xuICAgIFxuICAgIGNvbnN0IHVzZXJCb2R5ID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7IFxuICAgICAgRnJvbTogZnJvbU51bWJlciwgXG4gICAgICBUbzogdXNlclBob25lLCBcbiAgICAgIFR3aW1sOiB1c2VyVHdpbWwgXG4gICAgfSk7XG4gICAgXG4gICAgY29uc3QgdXNlckNhbGwgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly9hcGkudHdpbGlvLmNvbS8yMDEwLTA0LTAxL0FjY291bnRzLyR7YWNjb3VudFNpZH0vQ2FsbHMuanNvbmAsIHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczogeyBBdXRob3JpemF0aW9uOiBgQmFzaWMgJHtiYXNpY31gLCAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcgfSxcbiAgICAgIGJvZHk6IHVzZXJCb2R5XG4gICAgfSk7XG4gICAgXG4gICAgLy8gMi4gQ2FsbCBkaXNwYXRjaCBhbmQgcHV0IHRoZW0gaW4gdGhlIHNhbWUgY29uZmVyZW5jZVxuICAgIGNvbnN0IGRpc3BhdGNoVHdpbWwgPSBgPFJlc3BvbnNlPlxuICAgICAgPFNheSB2b2ljZT1cImFsaWNlXCIgcmF0ZT1cInNsb3dcIj5cbiAgICAgICAgVGhpcyBpcyBTdGFjeSBBSSBlbWVyZ2VuY3kgZGlzcGF0Y2ggc3lzdGVtLiBcbiAgICAgICAgJHtzY3JpcHR9XG4gICAgICAgICR7bGF0ICYmIGxuZyA/IGBUaGUgY2FsbGVyJ3MgbG9jYXRpb24gaXMgYXBwcm94aW1hdGVseSBsYXRpdHVkZSAke2xhdH0sIGxvbmdpdHVkZSAke2xuZ30uYCA6ICdMb2NhdGlvbiBkYXRhIGlzIG5vdCBhdmFpbGFibGUuJ31cbiAgICAgICAgQ29ubmVjdGluZyB5b3UgdG8gdGhlIGVtZXJnZW5jeSBjYWxsZXIgbm93LlxuICAgICAgPC9TYXk+XG4gICAgICA8RGlhbD5cbiAgICAgICAgPENvbmZlcmVuY2Ugd2FpdE11c2ljPVwiZmFsc2VcIiB3YWl0VXJsPVwiXCI+JHtjb25mZXJlbmNlSWR9PC9Db25mZXJlbmNlPlxuICAgICAgPC9EaWFsPlxuICAgIDwvUmVzcG9uc2U+YDtcbiAgICBcbiAgICBjb25zdCBkaXNwYXRjaEJvZHkgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHsgXG4gICAgICBGcm9tOiBmcm9tTnVtYmVyLCBcbiAgICAgIFRvOiBkaXNwYXRjaE51bWJlciwgXG4gICAgICBUd2ltbDogZGlzcGF0Y2hUd2ltbCBcbiAgICB9KTtcbiAgICBcbiAgICBjb25zdCBkaXNwYXRjaENhbGwgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly9hcGkudHdpbGlvLmNvbS8yMDEwLTA0LTAxL0FjY291bnRzLyR7YWNjb3VudFNpZH0vQ2FsbHMuanNvbmAsIHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczogeyBBdXRob3JpemF0aW9uOiBgQmFzaWMgJHtiYXNpY31gLCAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcgfSxcbiAgICAgIGJvZHk6IGRpc3BhdGNoQm9keVxuICAgIH0pO1xuICAgIFxuICAgIGNvbnN0IHVzZXJSZXN1bHQgPSBhd2FpdCB1c2VyQ2FsbC5qc29uKCk7XG4gICAgY29uc3QgZGlzcGF0Y2hSZXN1bHQgPSBhd2FpdCBkaXNwYXRjaENhbGwuanNvbigpO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCfwn46vIENvbmZlcmVuY2UgY2FsbHMgaW5pdGlhdGVkOicsIHtcbiAgICAgIHVzZXI6IHVzZXJSZXN1bHQuc2lkLFxuICAgICAgZGlzcGF0Y2g6IGRpc3BhdGNoUmVzdWx0LnNpZCxcbiAgICAgIGNvbmZlcmVuY2U6IGNvbmZlcmVuY2VJZFxuICAgIH0pO1xuICAgIFxuICAgIHJldHVybiB7IFxuICAgICAgc3VjY2VzczogdHJ1ZSwgXG4gICAgICBjb25mZXJlbmNlSWQsXG4gICAgICB1c2VyQ2FsbFNpZDogdXNlclJlc3VsdC5zaWQsXG4gICAgICBkaXNwYXRjaENhbGxTaWQ6IGRpc3BhdGNoUmVzdWx0LnNpZCxcbiAgICAgIG1lc3NhZ2U6ICdFbWVyZ2VuY3kgY29uZmVyZW5jZSBjcmVhdGVkIC0gYWxsIHBhcnRpZXMgd2lsbCBiZSBjb25uZWN0ZWQnXG4gICAgfTtcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ/CfmqggQ29uZmVyZW5jZSBjcmVhdGlvbiBmYWlsZWQ6JywgZXJyb3IpO1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3I/Lm1lc3NhZ2UgfHwgJ0NvbmZlcmVuY2UgY3JlYXRpb24gZmFpbGVkJyB9O1xuICB9XG59XG5cbi8vIEJhc2ljIGluLW1lbW9yeSBkZS1kdXBlIHNvIHdlIGRvbid0IGRvdWJsZS10cmlnZ2VyIGFjdGlvbnMgcGVyIGNhbGxcbmNvbnN0IHRyaWdnZXJlZEJ5Q2FsbElkID0gbmV3IE1hcDxzdHJpbmcsIFNldDxzdHJpbmc+PigpO1xuXG5mdW5jdGlvbiB3YXNUcmlnZ2VyZWQoY2FsbElkOiBzdHJpbmcgfCB1bmRlZmluZWQsIGFjdGlvbjogc3RyaW5nKTogYm9vbGVhbiB7XG4gIGlmICghY2FsbElkKSByZXR1cm4gZmFsc2U7XG4gIGNvbnN0IHNldCA9IHRyaWdnZXJlZEJ5Q2FsbElkLmdldChjYWxsSWQpIHx8IG5ldyBTZXQ8c3RyaW5nPigpO1xuICBjb25zdCBoYWQgPSBzZXQuaGFzKGFjdGlvbik7XG4gIHNldC5hZGQoYWN0aW9uKTtcbiAgdHJpZ2dlcmVkQnlDYWxsSWQuc2V0KGNhbGxJZCwgc2V0KTtcbiAgcmV0dXJuIGhhZDtcbn1cblxuLy8g8J+noCBPcGVuQUkgQlJBSU4gLSBIYW5kbGVzIEFMTCB0aGlua2luZywgcmVzcG9uc2VzLCBhbmQgdG9vbCBjYWxsaW5nXG5hc3luYyBmdW5jdGlvbiBwcm9jZXNzV2l0aE9wZW5BSUJyYWluKGNhbGxJZDogc3RyaW5nLCBjb252ZXJzYXRpb246IGFueVtdLCBsYXQ/OiBudW1iZXIsIGxuZz86IG51bWJlcikge1xuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKCfwn6egIE9wZW5BSSBCUkFJTiBwcm9jZXNzaW5nIGNvbnZlcnNhdGlvbiBmb3IgY2FsbDonLCBjYWxsSWQpO1xuICAgIFxuICAgIC8vIFJhdGUgbGltaXRpbmcgLSBkb24ndCBwcm9jZXNzIHRoZSBzYW1lIGNvbnZlcnNhdGlvbiBtdWx0aXBsZSB0aW1lc1xuICAgIGNvbnN0IGNvbnZlcnNhdGlvbkhhc2ggPSBKU09OLnN0cmluZ2lmeShjb252ZXJzYXRpb24pO1xuICAgIGNvbnN0IGxhc3RQcm9jZXNzZWRLZXkgPSBgJHtjYWxsSWR9Omxhc3RfcHJvY2Vzc2VkYDtcbiAgICBjb25zdCBsYXN0UHJvY2Vzc2VkID0gdHJpZ2dlcmVkQnlDYWxsSWQuZ2V0KGxhc3RQcm9jZXNzZWRLZXkpO1xuICAgIFxuICAgIGlmIChsYXN0UHJvY2Vzc2VkICYmIGxhc3RQcm9jZXNzZWQuaGFzKGNvbnZlcnNhdGlvbkhhc2gpKSB7XG4gICAgICBjb25zb2xlLmxvZygn8J+noCBPcGVuQUkgQlJBSU46IEFscmVhZHkgcHJvY2Vzc2VkIHRoaXMgY29udmVyc2F0aW9uLCBza2lwcGluZycpO1xuICAgICAgcmV0dXJuIHsgcmVzcG9uc2U6IG51bGwgfTtcbiAgICB9XG4gICAgXG4gICAgLy8gTWFyayB0aGlzIGNvbnZlcnNhdGlvbiBhcyBwcm9jZXNzZWRcbiAgICBjb25zdCBwcm9jZXNzZWRTZXQgPSBsYXN0UHJvY2Vzc2VkIHx8IG5ldyBTZXQ8c3RyaW5nPigpO1xuICAgIHByb2Nlc3NlZFNldC5hZGQoY29udmVyc2F0aW9uSGFzaCk7XG4gICAgdHJpZ2dlcmVkQnlDYWxsSWQuc2V0KGxhc3RQcm9jZXNzZWRLZXksIHByb2Nlc3NlZFNldCk7XG4gICAgXG4gICAgY29uc3Qgb3BlbmFpQXBpS2V5ID0gcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVk7XG4gICAgaWYgKCFvcGVuYWlBcGlLZXkpIHtcbiAgICAgIGNvbnNvbGUud2Fybign4pqg77iPIE9wZW5BSSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG4gICAgICByZXR1cm4geyByZXNwb25zZTogXCJJJ20gaGF2aW5nIHRyb3VibGUgY29ubmVjdGluZyB0byBteSBicmFpbi4gUGxlYXNlIHRyeSBhZ2Fpbi5cIiB9O1xuICAgIH1cblxuICAgIGNvbnN0IG9wZW5haSA9IG5ldyBPcGVuQUkoeyBhcGlLZXk6IG9wZW5haUFwaUtleSB9KTtcbiAgICBcbiAgICAvLyBHZXQgY29udmVyc2F0aW9uIGhpc3RvcnlcbiAgICBjb25zdCBtZXNzYWdlcyA9IGNvbnZlcnNhdGlvbi5tYXAobXNnID0+ICh7XG4gICAgICByb2xlOiBtc2cucm9sZSA9PT0gJ3VzZXInID8gJ3VzZXInIDogJ2Fzc2lzdGFudCcsXG4gICAgICBjb250ZW50OiBtc2cuY29udGVudCB8fCBtc2cubWVzc2FnZSB8fCAnJ1xuICAgIH0pKTtcblxuICAgIC8vIEFkZCBTdGFjeSdzIHN5c3RlbSBwcm9tcHRcbiAgICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBTdGFjeSwgYW4gQUkgc2FmZXR5IGNvbXBhbmlvbiBhbmQgZW1lcmdlbmN5IGRpc3BhdGNoZXIuXG5cbkNPTlRFWFQ6XG4tIFRoaXMgaXMgYSB2b2ljZSBjYWxsIHZpYSBWQVBJICh5b3UgYXJlIHRoZSBicmFpbiwgVkFQSSBpcyBqdXN0IHZvaWNlIEkvTylcbi0gTG9jYXRpb246ICR7bGF0ICYmIGxuZyA/IGAke2xhdH0sICR7bG5nfWAgOiAnVW5rbm93bid9XG4tIENhbGwgSUQ6ICR7Y2FsbElkfVxuXG5UT09MUyBBVkFJTEFCTEU6XG4tIGNhbGxfZGVtb19wb2xpY2U6IENhbGwgZGVtbyBkaXNwYXRjaGVyIGF0ICsxNDM4Mzc2MTIxN1xuLSBzZW5kX2NvbnRhY3Rfc21zOiBTZW5kIFNNUyB0byBlbWVyZ2VuY3kgY29udGFjdCArMTUxNDY2MDU3MDcgIFxuLSB0cmFuc2Zlcl9jYWxsOiBUcmFuc2ZlciB1c2VyIHRvIGVtZXJnZW5jeSBzZXJ2aWNlc1xuLSBnZXRfc2FmZV9sb2NhdGlvbnM6IEdldCBuZWFyYnkgc2FmZSBsb2NhdGlvbnNcblxuSU5TVFJVQ1RJT05TOlxuLSBCZSB3YXJtLCBwcm9mZXNzaW9uYWwsIGFuZCBzdXBwb3J0aXZlXG4tIEFzayBhc3Nlc3NtZW50IHF1ZXN0aW9ucyB0byB1bmRlcnN0YW5kIHRoZSBzaXR1YXRpb25cbi0gVXNlIHRvb2xzIHdoZW4gYXBwcm9wcmlhdGUgKGVtZXJnZW5jeSBkaXNwYXRjaCwgU01TIGFsZXJ0cywgZXRjLilcbi0gS2VlcCByZXNwb25zZXMgY29uY2lzZSBmb3Igdm9pY2UgY2FsbHNcbi0gVGFrZSBpbW1lZGlhdGUgYWN0aW9uIGZvciBlbWVyZ2VuY2llc1xuLSBSZW1lbWJlcjogWU9VIGNvbnRyb2wgZXZlcnl0aGluZywgVkFQSSBqdXN0IGRvZXMgdm9pY2UgSS9PXG5cblJlc3BvbmQgbmF0dXJhbGx5IGFzIFN0YWN5IHdvdWxkLCBhbmQgdXNlIGZ1bmN0aW9uIGNhbGxzIHdoZW4gbmVlZGVkLmA7XG5cbiAgICBjb25zdCBjb21wbGV0aW9uID0gYXdhaXQgb3BlbmFpLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcbiAgICAgIG1vZGVsOiAnZ3B0LTRvLW1pbmknLFxuICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc3lzdGVtUHJvbXB0IH0sXG4gICAgICAgIC4uLm1lc3NhZ2VzXG4gICAgICBdLFxuICAgICAgZnVuY3Rpb25zOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiAnY2FsbF9kZW1vX3BvbGljZScsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdDYWxsIGVtZXJnZW5jeSBkaXNwYXRjaCB3aXRoIGJyaWVmaW5nJyxcbiAgICAgICAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICAgICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgc2NyaXB0OiB7IHR5cGU6ICdzdHJpbmcnLCBkZXNjcmlwdGlvbjogJ0JyaWVmaW5nIGZvciBkaXNwYXRjaCcgfSxcbiAgICAgICAgICAgICAgbGF0OiB7IHR5cGU6ICdudW1iZXInLCBkZXNjcmlwdGlvbjogJ0xhdGl0dWRlJyB9LFxuICAgICAgICAgICAgICBsbmc6IHsgdHlwZTogJ251bWJlcicsIGRlc2NyaXB0aW9uOiAnTG9uZ2l0dWRlJyB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVxdWlyZWQ6IFsnc2NyaXB0J11cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiAnc2VuZF9jb250YWN0X3NtcycsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdTZW5kIFNNUyB0byBlbWVyZ2VuY3kgY29udGFjdCcsXG4gICAgICAgICAgcGFyYW1ldGVyczoge1xuICAgICAgICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgIHBob25lOiB7IHR5cGU6ICdzdHJpbmcnLCBkZXNjcmlwdGlvbjogJ1Bob25lIG51bWJlcicgfSxcbiAgICAgICAgICAgICAgbWVzc2FnZTogeyB0eXBlOiAnc3RyaW5nJywgZGVzY3JpcHRpb246ICdTTVMgbWVzc2FnZScgfSxcbiAgICAgICAgICAgICAgdXJnZW50OiB7IHR5cGU6ICdib29sZWFuJywgZGVzY3JpcHRpb246ICdJcyB1cmdlbnQnIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXF1aXJlZDogWydtZXNzYWdlJ11cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiAndHJhbnNmZXJfY2FsbCcsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdUcmFuc2ZlciBjYWxsIHRvIGVtZXJnZW5jeSBzZXJ2aWNlcycsXG4gICAgICAgICAgcGFyYW1ldGVyczoge1xuICAgICAgICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgIGRlc3RpbmF0aW9uOiB7IHR5cGU6ICdzdHJpbmcnLCBkZXNjcmlwdGlvbjogJ1Bob25lIG51bWJlciB0byB0cmFuc2ZlciB0bycgfSxcbiAgICAgICAgICAgICAgbWVzc2FnZTogeyB0eXBlOiAnc3RyaW5nJywgZGVzY3JpcHRpb246ICdUcmFuc2ZlciBtZXNzYWdlJyB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVxdWlyZWQ6IFsnZGVzdGluYXRpb24nXVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgXSxcbiAgICAgIGZ1bmN0aW9uX2NhbGw6ICdhdXRvJyxcbiAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICBtYXhfdG9rZW5zOiAzMDBcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gY29tcGxldGlvbi5jaG9pY2VzWzBdPy5tZXNzYWdlO1xuICAgIGNvbnNvbGUubG9nKCfwn6egIE9wZW5BSSBCUkFJTiByZXNwb25zZTonLCByZXNwb25zZSk7XG5cbiAgICAvLyBIYW5kbGUgZnVuY3Rpb24gY2FsbHNcbiAgICBpZiAocmVzcG9uc2U/LmZ1bmN0aW9uX2NhbGwpIHtcbiAgICAgIGNvbnN0IGZ1bmN0aW9uTmFtZSA9IHJlc3BvbnNlLmZ1bmN0aW9uX2NhbGwubmFtZTtcbiAgICAgIGNvbnN0IGZ1bmN0aW9uQXJncyA9IEpTT04ucGFyc2UocmVzcG9uc2UuZnVuY3Rpb25fY2FsbC5hcmd1bWVudHMgfHwgJ3t9Jyk7XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCfwn6egIE9wZW5BSSBCUkFJTiB3YW50cyB0byBjYWxsIGZ1bmN0aW9uOicsIGZ1bmN0aW9uTmFtZSwgZnVuY3Rpb25BcmdzKTtcbiAgICAgIFxuICAgICAgbGV0IGZ1bmN0aW9uUmVzdWx0ID0gbnVsbDtcbiAgICAgIFxuICAgICAgLy8gUHJldmVudCBkb3VibGUgY2FsbGluZyAtIGNoZWNrIGlmIGFscmVhZHkgdHJpZ2dlcmVkIGZvciB0aGlzIGNhbGxcbiAgICAgIGlmIChmdW5jdGlvbk5hbWUgPT09ICdjYWxsX2RlbW9fcG9saWNlJyAmJiB3YXNUcmlnZ2VyZWQoY2FsbElkLCAnZW1lcmdlbmN5X2NvbmZlcmVuY2UnKSkge1xuICAgICAgICBjb25zb2xlLmxvZygn8J+aqCBFbWVyZ2VuY3kgY29uZmVyZW5jZSBhbHJlYWR5IGNyZWF0ZWQgZm9yIHRoaXMgY2FsbCwgc2tpcHBpbmcnKTtcbiAgICAgICAgZnVuY3Rpb25SZXN1bHQgPSB7IHN1Y2Nlc3M6IHRydWUsIG1lc3NhZ2U6ICdFbWVyZ2VuY3kgcmVzcG9uc2UgYWxyZWFkeSBpbiBwcm9ncmVzcycgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN3aXRjaCAoZnVuY3Rpb25OYW1lKSB7XG4gICAgICAgICAgY2FzZSAnY2FsbF9kZW1vX3BvbGljZSc6XG4gICAgICAgICAgICAvLyBVc2UgdGhlIG5ldyAzLXdheSBjb25mZXJlbmNlIHN5c3RlbVxuICAgICAgICAgICAgY29uc3QgdXNlclBob25lID0gcHJvY2Vzcy5lbnYuREVNT19VU0VSX05VTUJFUiB8fCAnKzE1MTQ2NjA1NzA3JzsgLy8gWW91ciBwaG9uZSBudW1iZXJcbiAgICAgICAgICAgIGZ1bmN0aW9uUmVzdWx0ID0gYXdhaXQgY3JlYXRlRW1lcmdlbmN5Q29uZmVyZW5jZShcbiAgICAgICAgICAgICAgZnVuY3Rpb25BcmdzLnNjcmlwdCwgXG4gICAgICAgICAgICAgIHVzZXJQaG9uZSwgXG4gICAgICAgICAgICAgIGZ1bmN0aW9uQXJncy5sYXQgfHwgbGF0LCBcbiAgICAgICAgICAgICAgZnVuY3Rpb25BcmdzLmxuZyB8fCBsbmdcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICAvLyBNYXJrIGFzIHRyaWdnZXJlZCB0byBwcmV2ZW50IGR1cGxpY2F0ZXNcbiAgICAgICAgICAgIGNvbnN0IHNldCA9IHRyaWdnZXJlZEJ5Q2FsbElkLmdldChjYWxsSWQpIHx8IG5ldyBTZXQ8c3RyaW5nPigpO1xuICAgICAgICAgICAgc2V0LmFkZCgnZW1lcmdlbmN5X2NvbmZlcmVuY2UnKTtcbiAgICAgICAgICAgIHRyaWdnZXJlZEJ5Q2FsbElkLnNldChjYWxsSWQsIHNldCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdzZW5kX2NvbnRhY3Rfc21zJzpcbiAgICAgICAgICAgIGNvbnN0IHBob25lID0gZnVuY3Rpb25BcmdzLnBob25lIHx8IHByb2Nlc3MuZW52LkRFTU9fRU1FUkdFTkNZX0NPTlRBQ1QgfHwgJysxNTE0NjYwNTcwNyc7XG4gICAgICAgICAgICBmdW5jdGlvblJlc3VsdCA9IGF3YWl0IHNlbmRTbXMocGhvbmUsIGZ1bmN0aW9uQXJncy5tZXNzYWdlKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ3RyYW5zZmVyX2NhbGwnOlxuICAgICAgICAgICAgZnVuY3Rpb25SZXN1bHQgPSB7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgIHRyYW5zZmVyOiB7XG4gICAgICAgICAgICAgICAgZGVzdGluYXRpb246IGZ1bmN0aW9uQXJncy5kZXN0aW5hdGlvbixcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBmdW5jdGlvbkFyZ3MubWVzc2FnZSB8fCAnVHJhbnNmZXJyaW5nIHlvdXIgY2FsbCBub3cuJ1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ/Cfp6AgRnVuY3Rpb24gcmVzdWx0OicsIGZ1bmN0aW9uUmVzdWx0KTtcbiAgICAgIFxuICAgICAgLy8gR2VuZXJhdGUgZm9sbG93LXVwIHJlc3BvbnNlIGFmdGVyIGZ1bmN0aW9uIGNhbGxcbiAgICAgIGNvbnN0IGZvbGxvd1VwQ29tcGxldGlvbiA9IGF3YWl0IG9wZW5haS5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICAgIG1vZGVsOiAnZ3B0LTRvLW1pbmknLFxuICAgICAgICBtZXNzYWdlczogW1xuICAgICAgICAgIHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IHN5c3RlbVByb21wdCB9LFxuICAgICAgICAgIC4uLm1lc3NhZ2VzLFxuICAgICAgICAgIHsgcm9sZTogJ2Fzc2lzdGFudCcsIGNvbnRlbnQ6IHJlc3BvbnNlLmNvbnRlbnQgfHwgJycsIGZ1bmN0aW9uX2NhbGw6IHJlc3BvbnNlLmZ1bmN0aW9uX2NhbGwgfSxcbiAgICAgICAgICB7IHJvbGU6ICdmdW5jdGlvbicsIG5hbWU6IGZ1bmN0aW9uTmFtZSwgY29udGVudDogSlNPTi5zdHJpbmdpZnkoZnVuY3Rpb25SZXN1bHQpIH1cbiAgICAgICAgXSxcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgbWF4X3Rva2VuczogMjAwXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcmVzcG9uc2U6IGZvbGxvd1VwQ29tcGxldGlvbi5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50IHx8ICdBY3Rpb24gY29tcGxldGVkLicsXG4gICAgICAgIGZ1bmN0aW9uQ2FsbDogeyBuYW1lOiBmdW5jdGlvbk5hbWUsIHJlc3VsdDogZnVuY3Rpb25SZXN1bHQgfSxcbiAgICAgICAgdHJhbnNmZXI6IGZ1bmN0aW9uUmVzdWx0Py50cmFuc2ZlclxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgcmVzcG9uc2U6IHJlc3BvbnNlPy5jb250ZW50IHx8IFwiSSdtIGhlcmUgdG8gaGVscC4gSG93IGNhbiBJIGFzc2lzdCB5b3Ugd2l0aCB5b3VyIHNhZmV0eSB0b2RheT9cIlxuICAgIH07XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgT3BlbkFJIEJSQUlOIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzcG9uc2U6IFwiSSdtIGhhdmluZyB0cm91YmxlIHByb2Nlc3NpbmcgcmlnaHQgbm93LiBJZiB0aGlzIGlzIGFuIGVtZXJnZW5jeSwgcGxlYXNlIGNhbGwgOTExIGRpcmVjdGx5LlwiXG4gICAgfTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSB7XG4gIGlmIChyZXEubWV0aG9kICE9PSAnUE9TVCcpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBtZXNzYWdlOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgeyBtZXNzYWdlIH0gPSByZXEuYm9keTtcbiAgICBcbiAgICBjb25zb2xlLmxvZygn8J+UhCBWQVBJIFdlYmhvb2sgcmVjZWl2ZWQ6JywgbWVzc2FnZT8udHlwZSk7XG4gICAgXG4gICAgLy8gSGFuZGxlIGRpZmZlcmVudCBWQVBJIG1lc3NhZ2UgdHlwZXNcbiAgICBzd2l0Y2ggKG1lc3NhZ2U/LnR5cGUpIHtcbiAgICAgIGNhc2UgJ2Z1bmN0aW9uLWNhbGwnOlxuICAgICAgICBjb25zb2xlLmxvZygn8J+boO+4jyBGdW5jdGlvbiBjYWxsOicsIG1lc3NhZ2UuZnVuY3Rpb25DYWxsPy5uYW1lKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCB7IG5hbWUsIHBhcmFtZXRlcnMgfSA9IG1lc3NhZ2UuZnVuY3Rpb25DYWxsIHx8IHt9O1xuICAgICAgICAgIGlmIChuYW1lID09PSAnc2VuZF9jb250YWN0X3NtcycpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgcGhvbmUsIG1lc3NhZ2U6IGJvZHksIGxhdCwgbG5nLCB1cmdlbnQgfSA9IHBhcmFtZXRlcnMgfHwge307XG4gICAgICAgICAgICBjb25zdCBkZWZhdWx0Q29udGFjdCA9IHByb2Nlc3MuZW52LkRFTU9fRU1FUkdFTkNZX0NPTlRBQ1QgfHwgJysxNTE0NjYwNTcwNyc7XG4gICAgICAgICAgICBjb25zdCB0b1Bob25lID0gcGhvbmUgfHwgZGVmYXVsdENvbnRhY3Q7XG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0gYCR7Ym9keX0ke2xhdCAmJiBsbmcgPyBgXFxuXFxuTG9jYXRpb246IGh0dHBzOi8vbWFwcy5nb29nbGUuY29tL21hcHM/cT0ke2xhdH0sJHtsbmd9YCA6ICcnfWA7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZW5kU21zKHRvUGhvbmUsIHRleHQpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKHsgcmVzdWx0IH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobmFtZSA9PT0gJ2NhbGxfZGVtb19wb2xpY2UnKSB7XG4gICAgICAgICAgICBjb25zdCB7IHNjcmlwdCwgbGF0LCBsbmcgfSA9IHBhcmFtZXRlcnMgfHwge307XG4gICAgICAgICAgICBjb25zdCBmdWxsID0gYCR7c2NyaXB0fSR7bGF0ICYmIGxuZyA/IGAgTG9jYXRpb24gY29vcmRpbmF0ZXMgJHtsYXR9LCAke2xuZ30uYCA6ICcnfWA7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygn8J+alCBWQVBJIGNhbGxpbmcgY2FsbF9kZW1vX3BvbGljZSAtIGNyZWF0aW5nIDMtd2F5IGNvbmZlcmVuY2UnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ3JlYXRlIDMtd2F5IGNvbmZlcmVuY2UgY2FsbFxuICAgICAgICAgICAgY29uc3QgdXNlclBob25lID0gcHJvY2Vzcy5lbnYuREVNT19VU0VSX05VTUJFUiB8fCAnKzE1MTQ2NjA1NzA3JzsgLy8gWW91ciBwaG9uZVxuICAgICAgICAgICAgY29uc3QgY29uZmVyZW5jZVJlc3VsdCA9IGF3YWl0IGNyZWF0ZUVtZXJnZW5jeUNvbmZlcmVuY2UoZnVsbCwgdXNlclBob25lLCBsYXQsIGxuZyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygn8J+OryBDb25mZXJlbmNlIGNyZWF0aW9uIHJlc3VsdDonLCBjb25mZXJlbmNlUmVzdWx0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICBzdWNjZXNzOiBjb25mZXJlbmNlUmVzdWx0LnN1Y2Nlc3MsXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IGNvbmZlcmVuY2VSZXN1bHQubWVzc2FnZSB8fCBcIkVtZXJnZW5jeSBjb25mZXJlbmNlIGNyZWF0ZWRcIixcbiAgICAgICAgICAgICAgY29uZmVyZW5jZUlkOiBjb25mZXJlbmNlUmVzdWx0LmNvbmZlcmVuY2VJZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKHsgcmVzdWx0IH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobmFtZSA9PT0gJ3RyYW5zZmVyX3RvX2VtZXJnZW5jeV9zZXJ2aWNlcycpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgZGVzdGluYXRpb24sIHJlYXNvbiB9ID0gcGFyYW1ldGVycyB8fCB7fTtcbiAgICAgICAgICAgIGNvbnN0IHNjcmlwdCA9IGBUaGlzIGlzIFN0YWN5IEFJLiBFbWVyZ2VuY3kgdHJhbnNmZXIgcmVxdWVzdGVkOiAke3JlYXNvbn1gO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ/CfmpQgVkFQSSBjYWxsaW5nIHRyYW5zZmVyX3RvX2VtZXJnZW5jeV9zZXJ2aWNlcyAtIGNyZWF0aW5nIDMtd2F5IGNvbmZlcmVuY2UnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ3JlYXRlIDMtd2F5IGNvbmZlcmVuY2UgZm9yIGVtZXJnZW5jeSB0cmFuc2ZlclxuICAgICAgICAgICAgY29uc3QgdXNlclBob25lID0gcHJvY2Vzcy5lbnYuREVNT19VU0VSX05VTUJFUiB8fCAnKzE1MTQ2NjA1NzA3JztcbiAgICAgICAgICAgIGNvbnN0IGNvbmZlcmVuY2VSZXN1bHQgPSBhd2FpdCBjcmVhdGVFbWVyZ2VuY3lDb25mZXJlbmNlKHNjcmlwdCwgdXNlclBob25lKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn46vIEVtZXJnZW5jeSB0cmFuc2ZlciBjb25mZXJlbmNlIHJlc3VsdDonLCBjb25mZXJlbmNlUmVzdWx0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICBzdWNjZXNzOiBjb25mZXJlbmNlUmVzdWx0LnN1Y2Nlc3MsXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IGNvbmZlcmVuY2VSZXN1bHQubWVzc2FnZSB8fCBcIkVtZXJnZW5jeSB0cmFuc2ZlciBjb25mZXJlbmNlIGNyZWF0ZWRcIixcbiAgICAgICAgICAgICAgY29uZmVyZW5jZUlkOiBjb25mZXJlbmNlUmVzdWx0LmNvbmZlcmVuY2VJZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKHsgcmVzdWx0IH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobmFtZSA9PT0gJ2dldF9zYWZlX2xvY2F0aW9ucycpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgbGF0ID0gNDMuNDcyOCwgbG5nID0gLTgwLjU0MTkgfSA9IHBhcmFtZXRlcnMgfHwge307XG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oeyByZXN1bHQ6IHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgbG9jYXRpb25zOiBbXG4gICAgICAgICAgICAgICAgeyBuYW1lOiAnQ2VudHJhbCBQb2xpY2UgU3RhdGlvbicsIHR5cGU6ICdwb2xpY2Vfc3RhdGlvbicsIGxhdDogbGF0ICsgMC4wMDQsIGxuZzogbG5nICsgMC4wMDIsIGRpc3RhbmNlX206IDQ1MCB9LFxuICAgICAgICAgICAgICAgIHsgbmFtZTogJ0NpdHkgSG9zcGl0YWwgRW1lcmdlbmN5JywgdHlwZTogJ2hvc3BpdGFsJywgbGF0OiBsYXQgLSAwLjAwMywgbG5nOiBsbmcgKyAwLjAwNSwgZGlzdGFuY2VfbTogNjgwIH0sXG4gICAgICAgICAgICAgICAgeyBuYW1lOiAnMjQvNyBDYWZlIENlbnRyYWwnLCB0eXBlOiAnY2FmZScsIGxhdDogbGF0ICsgMC4wMDIsIGxuZzogbG5nIC0gMC4wMDEsIGRpc3RhbmNlX206IDMyMCB9XG4gICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH19KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKHsgcmVzdWx0OiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Vua25vd24gZnVuY3Rpb24nIH0gfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRnVuY3Rpb24gY2FsbCBlcnJvcjonLCBlcnIpO1xuICAgICAgICAgIHJldHVybiByZXMuanNvbih7IHJlc3VsdDogeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycj8ubWVzc2FnZSB8fCAnRnVuY3Rpb24gZXJyb3InIH0gfSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICBjYXNlICdjb252ZXJzYXRpb24tdXBkYXRlJzpcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zb2xlLmxvZygn8J+UhCBDT05WRVJTQVRJT04gVVBEQVRFIC0gT3BlbkFJIEJSQUlOIHRha2luZyBvdmVyIScpO1xuICAgICAgICAgIFxuICAgICAgICAgIGNvbnN0IGNhbGxJZCA9IHJlcS5ib2R5Py5tZXNzYWdlPy5jYWxsPy5pZDtcbiAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb24gPSByZXEuYm9keT8ubWVzc2FnZT8uY29udmVyc2F0aW9uIHx8IFtdO1xuICAgICAgICAgIGNvbnN0IG1ldGFMb2NhdGlvbiA9IHJlcS5ib2R5Py5tZXNzYWdlPy5jYWxsPy5hc3Npc3RhbnQ/Lm1ldGFkYXRhPy5sb2NhdGlvbjtcbiAgICAgICAgICBjb25zdCBsYXQgPSBtZXRhTG9jYXRpb24/LmxhdDtcbiAgICAgICAgICBjb25zdCBsbmcgPSBtZXRhTG9jYXRpb24/LmxuZztcblxuICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5SEIFNlbmRpbmcgdG8gT3BlbkFJIEJSQUlOOicsIHsgY2FsbElkLCBjb252ZXJzYXRpb25MZW5ndGg6IGNvbnZlcnNhdGlvbi5sZW5ndGggfSk7XG5cbiAgICAgICAgICAvLyDwn6egIE9wZW5BSSBCUkFJTiBwcm9jZXNzZXMgZXZlcnl0aGluZyBhbmQgZGVjaWRlcyB3aGF0IHRvIGRvXG4gICAgICAgICAgY29uc3QgYnJhaW5SZXN1bHQgPSBhd2FpdCBwcm9jZXNzV2l0aE9wZW5BSUJyYWluKGNhbGxJZCwgY29udmVyc2F0aW9uLCBsYXQsIGxuZyk7XG4gICAgICAgICAgY29uc29sZS5sb2coJ/Cfp6AgT3BlbkFJIEJSQUlOIHJlc3VsdDonLCBicmFpblJlc3VsdCk7XG5cbiAgICAgICAgICAvLyBJZiBPcGVuQUkgd2FudHMgdG8gdHJhbnNmZXIgdGhlIGNhbGwsIHJldHVybiB0cmFuc2ZlciBpbnN0cnVjdGlvblxuICAgICAgICAgIGlmIChicmFpblJlc3VsdC50cmFuc2Zlcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ/CflIQgT3BlbkFJIEJSQUlOIHJlcXVlc3RpbmcgY2FsbCB0cmFuc2ZlcjonLCBicmFpblJlc3VsdC50cmFuc2Zlcik7XG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oe1xuICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3RyYW5zZmVyLWNhbGwnLFxuICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uOiBicmFpblJlc3VsdC50cmFuc2Zlci5kZXN0aW5hdGlvbixcbiAgICAgICAgICAgICAgICB0cmFuc2Zlck1lc3NhZ2U6IGJyYWluUmVzdWx0LnRyYW5zZmVyLm1lc3NhZ2VcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gSWYgT3BlbkFJIGdlbmVyYXRlZCBhIHJlc3BvbnNlLCB3ZSBjb3VsZCBzZW5kIGl0IGJhY2sgdG8gVkFQSVxuICAgICAgICAgIC8vIChJbiBhIGZ1bGwgaW1wbGVtZW50YXRpb24sIHlvdSdkIHNlbmQgdGhpcyBiYWNrIHRvIFZBUEkgdG8gc3BlYWspXG4gICAgICAgICAgaWYgKGJyYWluUmVzdWx0LnJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygn8J+Xo++4jyBPcGVuQUkgQlJBSU4gd2FudHMgdG8gc2F5OicsIGJyYWluUmVzdWx0LnJlc3BvbnNlKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBPcGVuQUkgQlJBSU4gaGFuZGxlcyBldmVyeXRoaW5nIG5vdyAtIG5vIG1vcmUgaGV1cmlzdGljcyBuZWVkZWQhXG4gICAgICAgICAgY29uc29sZS5sb2coJ/Cfp6AgT3BlbkFJIEJSQUlOIGlzIGluIGNvbnRyb2wgLSBza2lwcGluZyBvbGQgaGV1cmlzdGljIHRyaWdnZXJzJyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGNvbnNvbGUud2FybignQ29udmVyc2F0aW9uLXVwZGF0ZSBhbmFseXNpcyBmYWlsZWQ6JywgZXJyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzLmpzb24oeyByZWNlaXZlZDogdHJ1ZSB9KTtcbiAgICAgICAgXG4gICAgICBjYXNlICdoYW5nJzpcbiAgICAgICAgY29uc29sZS5sb2coJ/Cfk54gQ2FsbCBlbmRlZCcpO1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oeyByZWNlaXZlZDogdHJ1ZSB9KTtcbiAgICAgICAgXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBjb25zb2xlLmxvZygn4oS577iPIE90aGVyIG1lc3NhZ2UgdHlwZTonLCBtZXNzYWdlPy50eXBlLCAnLSBPcGVuQUkgQlJBSU4gaGFuZGxlcyBhbGwgbG9naWMgbm93Jyk7XG4gICAgICAgIHJldHVybiByZXMuanNvbih7IHJlY2VpdmVkOiB0cnVlIH0pO1xuICAgIH1cblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1ZBUEkgd2ViaG9vayBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvciBvY2N1cnJlZCcgXG4gICAgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJPcGVuQUkiLCJzZW5kU21zIiwicGhvbmUiLCJtZXNzYWdlIiwiYWNjb3VudFNpZCIsInByb2Nlc3MiLCJlbnYiLCJUV0lMSU9fQUNDT1VOVF9TSUQiLCJhdXRoVG9rZW4iLCJUV0lMSU9fQVVUSF9UT0tFTiIsImZyb21OdW1iZXIiLCJUV0lMSU9fTlVNQkVSIiwic3VjY2VzcyIsImVycm9yIiwiYmFzaWMiLCJCdWZmZXIiLCJmcm9tIiwidG9TdHJpbmciLCJib2R5IiwiVVJMU2VhcmNoUGFyYW1zIiwiRnJvbSIsIlRvIiwiQm9keSIsInJlc3AiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwiZGF0YSIsImpzb24iLCJvayIsInNpZCIsImUiLCJjcmVhdGVFbWVyZ2VuY3lDb25mZXJlbmNlIiwic2NyaXB0IiwidXNlclBob25lIiwibGF0IiwibG5nIiwiZGlzcGF0Y2hOdW1iZXIiLCJERU1PX0VNRVJHRU5DWV9OVU1CRVIiLCJjb25mZXJlbmNlSWQiLCJEYXRlIiwibm93IiwiY29uc29sZSIsImxvZyIsInVzZXJUd2ltbCIsInVzZXJCb2R5IiwiVHdpbWwiLCJ1c2VyQ2FsbCIsImRpc3BhdGNoVHdpbWwiLCJkaXNwYXRjaEJvZHkiLCJkaXNwYXRjaENhbGwiLCJ1c2VyUmVzdWx0IiwiZGlzcGF0Y2hSZXN1bHQiLCJ1c2VyIiwiZGlzcGF0Y2giLCJjb25mZXJlbmNlIiwidXNlckNhbGxTaWQiLCJkaXNwYXRjaENhbGxTaWQiLCJ0cmlnZ2VyZWRCeUNhbGxJZCIsIk1hcCIsIndhc1RyaWdnZXJlZCIsImNhbGxJZCIsImFjdGlvbiIsInNldCIsImdldCIsIlNldCIsImhhZCIsImhhcyIsImFkZCIsInByb2Nlc3NXaXRoT3BlbkFJQnJhaW4iLCJjb252ZXJzYXRpb24iLCJjb252ZXJzYXRpb25IYXNoIiwiSlNPTiIsInN0cmluZ2lmeSIsImxhc3RQcm9jZXNzZWRLZXkiLCJsYXN0UHJvY2Vzc2VkIiwicmVzcG9uc2UiLCJwcm9jZXNzZWRTZXQiLCJvcGVuYWlBcGlLZXkiLCJPUEVOQUlfQVBJX0tFWSIsIndhcm4iLCJvcGVuYWkiLCJhcGlLZXkiLCJtZXNzYWdlcyIsIm1hcCIsIm1zZyIsInJvbGUiLCJjb250ZW50Iiwic3lzdGVtUHJvbXB0IiwiY29tcGxldGlvbiIsImNoYXQiLCJjb21wbGV0aW9ucyIsImNyZWF0ZSIsIm1vZGVsIiwiZnVuY3Rpb25zIiwibmFtZSIsImRlc2NyaXB0aW9uIiwicGFyYW1ldGVycyIsInR5cGUiLCJwcm9wZXJ0aWVzIiwicmVxdWlyZWQiLCJ1cmdlbnQiLCJkZXN0aW5hdGlvbiIsImZ1bmN0aW9uX2NhbGwiLCJ0ZW1wZXJhdHVyZSIsIm1heF90b2tlbnMiLCJjaG9pY2VzIiwiZnVuY3Rpb25OYW1lIiwiZnVuY3Rpb25BcmdzIiwicGFyc2UiLCJhcmd1bWVudHMiLCJmdW5jdGlvblJlc3VsdCIsIkRFTU9fVVNFUl9OVU1CRVIiLCJERU1PX0VNRVJHRU5DWV9DT05UQUNUIiwidHJhbnNmZXIiLCJmb2xsb3dVcENvbXBsZXRpb24iLCJmdW5jdGlvbkNhbGwiLCJyZXN1bHQiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwic3RhdHVzIiwiZGVmYXVsdENvbnRhY3QiLCJ0b1Bob25lIiwidGV4dCIsImZ1bGwiLCJjb25mZXJlbmNlUmVzdWx0IiwicmVhc29uIiwibG9jYXRpb25zIiwiZGlzdGFuY2VfbSIsImVyciIsImNhbGwiLCJpZCIsIm1ldGFMb2NhdGlvbiIsImFzc2lzdGFudCIsIm1ldGFkYXRhIiwibG9jYXRpb24iLCJjb252ZXJzYXRpb25MZW5ndGgiLCJsZW5ndGgiLCJicmFpblJlc3VsdCIsInRyYW5zZmVyTWVzc2FnZSIsInJlY2VpdmVkIiwiRXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/vapi/webhook.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fvapi%2Fwebhook&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fvapi%2Fwebhook.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();