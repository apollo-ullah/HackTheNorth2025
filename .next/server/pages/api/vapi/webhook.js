"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/vapi/webhook";
exports.ids = ["pages/api/vapi/webhook"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fvapi%2Fwebhook&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fvapi%2Fwebhook.ts&middlewareConfigBase64=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fvapi%2Fwebhook&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fvapi%2Fwebhook.ts&middlewareConfigBase64=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_vapi_webhook_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/vapi/webhook.ts */ \"(api)/./pages/api/vapi/webhook.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_vapi_webhook_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_vapi_webhook_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/vapi/webhook\",\n        pathname: \"/api/vapi/webhook\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_vapi_webhook_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnZhcGklMkZ3ZWJob29rJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlMkZhcGklMkZ2YXBpJTJGd2ViaG9vay50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUN3RDtBQUN4RDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsdURBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHVEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsid2VicGFjazovL3N0YWN5LWFpLXNhZmV0eS1jb21wYW5pb24vP2I5OTMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzL2FwaS92YXBpL3dlYmhvb2sudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS92YXBpL3dlYmhvb2tcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS92YXBpL3dlYmhvb2tcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fvapi%2Fwebhook&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fvapi%2Fwebhook.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/vapi/webhook.ts":
/*!***********************************!*\
  !*** ./pages/api/vapi/webhook.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\nasync function sendSms(phone, message) {\n    try {\n        const accountSid = process.env.TWILIO_ACCOUNT_SID;\n        const authToken = process.env.TWILIO_AUTH_TOKEN;\n        const fromNumber = process.env.TWILIO_NUMBER;\n        if (!accountSid || !authToken || !fromNumber) return {\n            success: false,\n            error: \"Twilio not configured\"\n        };\n        const basic = Buffer.from(`${accountSid}:${authToken}`).toString(\"base64\");\n        const body = new URLSearchParams({\n            From: fromNumber,\n            To: phone,\n            Body: message\n        });\n        const resp = await fetch(`https://api.twilio.com/2010-04-01/Accounts/${accountSid}/Messages.json`, {\n            method: \"POST\",\n            headers: {\n                Authorization: `Basic ${basic}`,\n                \"Content-Type\": \"application/x-www-form-urlencoded\"\n            },\n            body\n        });\n        const data = await resp.json();\n        if (!resp.ok) return {\n            success: false,\n            error: data?.message || \"Twilio SMS failed\"\n        };\n        return {\n            success: true,\n            sid: data.sid\n        };\n    } catch (e) {\n        return {\n            success: false,\n            error: e?.message || \"SMS error\"\n        };\n    }\n}\nasync function callDemoPolice(script) {\n    const accountSid = process.env.TWILIO_ACCOUNT_SID;\n    const authToken = process.env.TWILIO_AUTH_TOKEN;\n    const fromNumber = process.env.TWILIO_NUMBER;\n    const toNumber = process.env.DEMO_EMERGENCY_NUMBER || process.env.DEMO_POLICE_NUMBER || \"+14383761217\";\n    if (!accountSid || !authToken || !fromNumber) return {\n        success: false,\n        error: \"Twilio not configured\"\n    };\n    const twiml = `<Response><Say voice=\"alice\" rate=\"slow\">${script}</Say></Response>`;\n    const basic = Buffer.from(`${accountSid}:${authToken}`).toString(\"base64\");\n    const body = new URLSearchParams({\n        From: fromNumber,\n        To: toNumber,\n        Twiml: twiml\n    });\n    const resp = await fetch(`https://api.twilio.com/2010-04-01/Accounts/${accountSid}/Calls.json`, {\n        method: \"POST\",\n        headers: {\n            Authorization: `Basic ${basic}`,\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n        },\n        body\n    });\n    const data = await resp.json();\n    if (!resp.ok) return {\n        success: false,\n        error: data?.message || \"Twilio call failed\"\n    };\n    return {\n        success: true,\n        sid: data.sid\n    };\n}\n// Basic in-memory de-dupe so we don't double-trigger actions per call\nconst triggeredByCallId = new Map();\nfunction wasTriggered(callId, action) {\n    if (!callId) return false;\n    const set = triggeredByCallId.get(callId) || new Set();\n    const had = set.has(action);\n    set.add(action);\n    triggeredByCallId.set(callId, set);\n    return had;\n}\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            message: \"Method not allowed\"\n        });\n    }\n    try {\n        const { message } = req.body;\n        console.log(\"\\uD83D\\uDD04 VAPI Webhook received:\", message?.type);\n        // Handle different VAPI message types\n        switch(message?.type){\n            case \"function-call\":\n                console.log(\"\\uD83D\\uDEE0️ Function call:\", message.functionCall?.name);\n                try {\n                    const { name, parameters } = message.functionCall || {};\n                    if (name === \"send_contact_sms\") {\n                        const { phone, message: body, lat, lng, urgent } = parameters || {};\n                        const defaultContact = process.env.DEMO_EMERGENCY_CONTACT || \"+15146605707\";\n                        const toPhone = phone || defaultContact;\n                        const text = `${body}${lat && lng ? `\\n\\nLocation: https://maps.google.com/maps?q=${lat},${lng}` : \"\"}`;\n                        const result = await sendSms(toPhone, text);\n                        return res.json({\n                            result\n                        });\n                    }\n                    if (name === \"call_demo_police\") {\n                        const { script, lat, lng } = parameters || {};\n                        const full = `${script}${lat && lng ? ` Location coordinates ${lat}, ${lng}.` : \"\"}`;\n                        const result = await callDemoPolice(full);\n                        return res.json({\n                            result\n                        });\n                    }\n                    if (name === \"get_safe_locations\") {\n                        const { lat = 43.4728, lng = -80.5419 } = parameters || {};\n                        return res.json({\n                            result: {\n                                success: true,\n                                locations: [\n                                    {\n                                        name: \"Central Police Station\",\n                                        type: \"police_station\",\n                                        lat: lat + 0.004,\n                                        lng: lng + 0.002,\n                                        distance_m: 450\n                                    },\n                                    {\n                                        name: \"City Hospital Emergency\",\n                                        type: \"hospital\",\n                                        lat: lat - 0.003,\n                                        lng: lng + 0.005,\n                                        distance_m: 680\n                                    },\n                                    {\n                                        name: \"24/7 Cafe Central\",\n                                        type: \"cafe\",\n                                        lat: lat + 0.002,\n                                        lng: lng - 0.001,\n                                        distance_m: 320\n                                    }\n                                ]\n                            }\n                        });\n                    }\n                    return res.json({\n                        result: {\n                            success: false,\n                            error: \"Unknown function\"\n                        }\n                    });\n                } catch (err) {\n                    console.error(\"Function call error:\", err);\n                    return res.json({\n                        result: {\n                            success: false,\n                            error: err?.message || \"Function error\"\n                        }\n                    });\n                }\n            case \"conversation-update\":\n                try {\n                    const callId = req.body?.message?.call?.id;\n                    const messages = req.body?.message?.conversation?.messages || [];\n                    const last = messages[messages.length - 1];\n                    const text = last?.content || \"\";\n                    const lower = (text || \"\").toLowerCase();\n                    const metaLocation = req.body?.message?.call?.assistant?.metadata?.location;\n                    const lat = metaLocation?.lat;\n                    const lng = metaLocation?.lng;\n                    // Heuristic fallback triggers if model speaks intent but didn't emit a function-call\n                    if (lower.includes(\"call the dispatcher\") || lower.includes(\"calling the dispatcher\") || lower.includes(\"calling police\") || lower.includes(\"calling 911\")) {\n                        if (!wasTriggered(callId, \"call_demo_police\")) {\n                            const script = \"This is Stacy, an AI safety assistant. The caller requested a connection to the dispatcher. This is a demo call.\";\n                            const result = await callDemoPolice(script + (lat && lng ? ` Location coordinates ${lat}, ${lng}.` : \"\"));\n                            console.log(\"\\uD83D\\uDE94 Heuristic dispatcher call result:\", result);\n                        }\n                    }\n                    if (lower.includes(\"text\") && (lower.includes(\"contact\") || lower.includes(\"emergency contact\") || lower.includes(\"notify\"))) {\n                        if (!wasTriggered(callId, \"send_contact_sms\")) {\n                            const toPhone = process.env.DEMO_EMERGENCY_CONTACT || \"+15146605707\";\n                            const msg = \"Automated safety alert from Stacy AI. The user requested assistance.\" + (lat && lng ? `\\n\\nLocation: https://maps.google.com/maps?q=${lat},${lng}` : \"\");\n                            const result = await sendSms(toPhone, msg);\n                            console.log(\"\\uD83D\\uDCF1 Heuristic SMS result:\", result);\n                        }\n                    }\n                } catch (err) {\n                    console.warn(\"Conversation-update heuristic failed:\", err);\n                }\n                return res.json({\n                    received: true\n                });\n            case \"hang\":\n                console.log(\"\\uD83D\\uDCDE Call ended\");\n                return res.json({\n                    received: true\n                });\n            default:\n                console.log(\"ℹ️ Other message type:\", message?.type);\n                return res.json({\n                    received: true\n                });\n        }\n    } catch (error) {\n        console.error(\"VAPI webhook error:\", error);\n        return res.status(500).json({\n            error: error instanceof Error ? error.message : \"Unknown error occurred\"\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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d2ViaG9vay50cz9hM2Q3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcblxuYXN5bmMgZnVuY3Rpb24gc2VuZFNtcyhwaG9uZTogc3RyaW5nLCBtZXNzYWdlOiBzdHJpbmcpOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgc2lkPzogc3RyaW5nOyBlcnJvcj86IHN0cmluZyB9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgYWNjb3VudFNpZCA9IHByb2Nlc3MuZW52LlRXSUxJT19BQ0NPVU5UX1NJRDtcbiAgICBjb25zdCBhdXRoVG9rZW4gPSBwcm9jZXNzLmVudi5UV0lMSU9fQVVUSF9UT0tFTjtcbiAgICBjb25zdCBmcm9tTnVtYmVyID0gcHJvY2Vzcy5lbnYuVFdJTElPX05VTUJFUjtcbiAgICBpZiAoIWFjY291bnRTaWQgfHwgIWF1dGhUb2tlbiB8fCAhZnJvbU51bWJlcikgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVHdpbGlvIG5vdCBjb25maWd1cmVkJyB9O1xuICAgIGNvbnN0IGJhc2ljID0gQnVmZmVyLmZyb20oYCR7YWNjb3VudFNpZH06JHthdXRoVG9rZW59YCkudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuICAgIGNvbnN0IGJvZHkgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHsgRnJvbTogZnJvbU51bWJlciwgVG86IHBob25lLCBCb2R5OiBtZXNzYWdlIH0pO1xuICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly9hcGkudHdpbGlvLmNvbS8yMDEwLTA0LTAxL0FjY291bnRzLyR7YWNjb3VudFNpZH0vTWVzc2FnZXMuanNvbmAsIHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczogeyBBdXRob3JpemF0aW9uOiBgQmFzaWMgJHtiYXNpY31gLCAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcgfSxcbiAgICAgIGJvZHlcbiAgICB9KTtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcC5qc29uKCk7XG4gICAgaWYgKCFyZXNwLm9rKSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGRhdGE/Lm1lc3NhZ2UgfHwgJ1R3aWxpbyBTTVMgZmFpbGVkJyB9O1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHNpZDogZGF0YS5zaWQgfTtcbiAgfSBjYXRjaCAoZTogYW55KSB7XG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlPy5tZXNzYWdlIHx8ICdTTVMgZXJyb3InIH07XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gY2FsbERlbW9Qb2xpY2Uoc2NyaXB0OiBzdHJpbmcpIHtcbiAgY29uc3QgYWNjb3VudFNpZCA9IHByb2Nlc3MuZW52LlRXSUxJT19BQ0NPVU5UX1NJRDtcbiAgY29uc3QgYXV0aFRva2VuID0gcHJvY2Vzcy5lbnYuVFdJTElPX0FVVEhfVE9LRU47XG4gIGNvbnN0IGZyb21OdW1iZXIgPSBwcm9jZXNzLmVudi5UV0lMSU9fTlVNQkVSO1xuICBjb25zdCB0b051bWJlciA9IHByb2Nlc3MuZW52LkRFTU9fRU1FUkdFTkNZX05VTUJFUiB8fCBwcm9jZXNzLmVudi5ERU1PX1BPTElDRV9OVU1CRVIgfHwgJysxNDM4Mzc2MTIxNyc7XG4gIGlmICghYWNjb3VudFNpZCB8fCAhYXV0aFRva2VuIHx8ICFmcm9tTnVtYmVyKSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdUd2lsaW8gbm90IGNvbmZpZ3VyZWQnIH07XG4gIGNvbnN0IHR3aW1sID0gYDxSZXNwb25zZT48U2F5IHZvaWNlPVwiYWxpY2VcIiByYXRlPVwic2xvd1wiPiR7c2NyaXB0fTwvU2F5PjwvUmVzcG9uc2U+YDtcbiAgY29uc3QgYmFzaWMgPSBCdWZmZXIuZnJvbShgJHthY2NvdW50U2lkfToke2F1dGhUb2tlbn1gKS50b1N0cmluZygnYmFzZTY0Jyk7XG4gIGNvbnN0IGJvZHkgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHsgRnJvbTogZnJvbU51bWJlciwgVG86IHRvTnVtYmVyLCBUd2ltbDogdHdpbWwgfSk7XG4gIGNvbnN0IHJlc3AgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly9hcGkudHdpbGlvLmNvbS8yMDEwLTA0LTAxL0FjY291bnRzLyR7YWNjb3VudFNpZH0vQ2FsbHMuanNvbmAsIHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBoZWFkZXJzOiB7IEF1dGhvcml6YXRpb246IGBCYXNpYyAke2Jhc2ljfWAsICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyB9LFxuICAgIGJvZHlcbiAgfSk7XG4gIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwLmpzb24oKTtcbiAgaWYgKCFyZXNwLm9rKSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGRhdGE/Lm1lc3NhZ2UgfHwgJ1R3aWxpbyBjYWxsIGZhaWxlZCcgfTtcbiAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgc2lkOiBkYXRhLnNpZCB9O1xufVxuXG4vLyBCYXNpYyBpbi1tZW1vcnkgZGUtZHVwZSBzbyB3ZSBkb24ndCBkb3VibGUtdHJpZ2dlciBhY3Rpb25zIHBlciBjYWxsXG5jb25zdCB0cmlnZ2VyZWRCeUNhbGxJZCA9IG5ldyBNYXA8c3RyaW5nLCBTZXQ8c3RyaW5nPj4oKTtcblxuZnVuY3Rpb24gd2FzVHJpZ2dlcmVkKGNhbGxJZDogc3RyaW5nIHwgdW5kZWZpbmVkLCBhY3Rpb246IHN0cmluZyk6IGJvb2xlYW4ge1xuICBpZiAoIWNhbGxJZCkgcmV0dXJuIGZhbHNlO1xuICBjb25zdCBzZXQgPSB0cmlnZ2VyZWRCeUNhbGxJZC5nZXQoY2FsbElkKSB8fCBuZXcgU2V0PHN0cmluZz4oKTtcbiAgY29uc3QgaGFkID0gc2V0LmhhcyhhY3Rpb24pO1xuICBzZXQuYWRkKGFjdGlvbik7XG4gIHRyaWdnZXJlZEJ5Q2FsbElkLnNldChjYWxsSWQsIHNldCk7XG4gIHJldHVybiBoYWQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IG1lc3NhZ2U6ICdNZXRob2Qgbm90IGFsbG93ZWQnIH0pO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB7IG1lc3NhZ2UgfSA9IHJlcS5ib2R5O1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCfwn5SEIFZBUEkgV2ViaG9vayByZWNlaXZlZDonLCBtZXNzYWdlPy50eXBlKTtcbiAgICBcbiAgICAvLyBIYW5kbGUgZGlmZmVyZW50IFZBUEkgbWVzc2FnZSB0eXBlc1xuICAgIHN3aXRjaCAobWVzc2FnZT8udHlwZSkge1xuICAgICAgY2FzZSAnZnVuY3Rpb24tY2FsbCc6XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5ug77iPIEZ1bmN0aW9uIGNhbGw6JywgbWVzc2FnZS5mdW5jdGlvbkNhbGw/Lm5hbWUpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHsgbmFtZSwgcGFyYW1ldGVycyB9ID0gbWVzc2FnZS5mdW5jdGlvbkNhbGwgfHwge307XG4gICAgICAgICAgaWYgKG5hbWUgPT09ICdzZW5kX2NvbnRhY3Rfc21zJykge1xuICAgICAgICAgICAgY29uc3QgeyBwaG9uZSwgbWVzc2FnZTogYm9keSwgbGF0LCBsbmcsIHVyZ2VudCB9ID0gcGFyYW1ldGVycyB8fCB7fTtcbiAgICAgICAgICAgIGNvbnN0IGRlZmF1bHRDb250YWN0ID0gcHJvY2Vzcy5lbnYuREVNT19FTUVSR0VOQ1lfQ09OVEFDVCB8fCAnKzE1MTQ2NjA1NzA3JztcbiAgICAgICAgICAgIGNvbnN0IHRvUGhvbmUgPSBwaG9uZSB8fCBkZWZhdWx0Q29udGFjdDtcbiAgICAgICAgICAgIGNvbnN0IHRleHQgPSBgJHtib2R5fSR7bGF0ICYmIGxuZyA/IGBcXG5cXG5Mb2NhdGlvbjogaHR0cHM6Ly9tYXBzLmdvb2dsZS5jb20vbWFwcz9xPSR7bGF0fSwke2xuZ31gIDogJyd9YDtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlbmRTbXModG9QaG9uZSwgdGV4dCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oeyByZXN1bHQgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChuYW1lID09PSAnY2FsbF9kZW1vX3BvbGljZScpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgc2NyaXB0LCBsYXQsIGxuZyB9ID0gcGFyYW1ldGVycyB8fCB7fTtcbiAgICAgICAgICAgIGNvbnN0IGZ1bGwgPSBgJHtzY3JpcHR9JHtsYXQgJiYgbG5nID8gYCBMb2NhdGlvbiBjb29yZGluYXRlcyAke2xhdH0sICR7bG5nfS5gIDogJyd9YDtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhbGxEZW1vUG9saWNlKGZ1bGwpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKHsgcmVzdWx0IH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobmFtZSA9PT0gJ2dldF9zYWZlX2xvY2F0aW9ucycpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgbGF0ID0gNDMuNDcyOCwgbG5nID0gLTgwLjU0MTkgfSA9IHBhcmFtZXRlcnMgfHwge307XG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oeyByZXN1bHQ6IHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgbG9jYXRpb25zOiBbXG4gICAgICAgICAgICAgICAgeyBuYW1lOiAnQ2VudHJhbCBQb2xpY2UgU3RhdGlvbicsIHR5cGU6ICdwb2xpY2Vfc3RhdGlvbicsIGxhdDogbGF0ICsgMC4wMDQsIGxuZzogbG5nICsgMC4wMDIsIGRpc3RhbmNlX206IDQ1MCB9LFxuICAgICAgICAgICAgICAgIHsgbmFtZTogJ0NpdHkgSG9zcGl0YWwgRW1lcmdlbmN5JywgdHlwZTogJ2hvc3BpdGFsJywgbGF0OiBsYXQgLSAwLjAwMywgbG5nOiBsbmcgKyAwLjAwNSwgZGlzdGFuY2VfbTogNjgwIH0sXG4gICAgICAgICAgICAgICAgeyBuYW1lOiAnMjQvNyBDYWZlIENlbnRyYWwnLCB0eXBlOiAnY2FmZScsIGxhdDogbGF0ICsgMC4wMDIsIGxuZzogbG5nIC0gMC4wMDEsIGRpc3RhbmNlX206IDMyMCB9XG4gICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH19KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKHsgcmVzdWx0OiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Vua25vd24gZnVuY3Rpb24nIH0gfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRnVuY3Rpb24gY2FsbCBlcnJvcjonLCBlcnIpO1xuICAgICAgICAgIHJldHVybiByZXMuanNvbih7IHJlc3VsdDogeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycj8ubWVzc2FnZSB8fCAnRnVuY3Rpb24gZXJyb3InIH0gfSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICBjYXNlICdjb252ZXJzYXRpb24tdXBkYXRlJzpcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBjYWxsSWQgPSByZXEuYm9keT8ubWVzc2FnZT8uY2FsbD8uaWQ7XG4gICAgICAgICAgY29uc3QgbWVzc2FnZXMgPSByZXEuYm9keT8ubWVzc2FnZT8uY29udmVyc2F0aW9uPy5tZXNzYWdlcyB8fCBbXTtcbiAgICAgICAgICBjb25zdCBsYXN0ID0gbWVzc2FnZXNbbWVzc2FnZXMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgY29uc3QgdGV4dDogc3RyaW5nID0gbGFzdD8uY29udGVudCB8fCAnJztcbiAgICAgICAgICBjb25zdCBsb3dlciA9ICh0ZXh0IHx8ICcnKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgIGNvbnN0IG1ldGFMb2NhdGlvbiA9IHJlcS5ib2R5Py5tZXNzYWdlPy5jYWxsPy5hc3Npc3RhbnQ/Lm1ldGFkYXRhPy5sb2NhdGlvbjtcbiAgICAgICAgICBjb25zdCBsYXQgPSBtZXRhTG9jYXRpb24/LmxhdDtcbiAgICAgICAgICBjb25zdCBsbmcgPSBtZXRhTG9jYXRpb24/LmxuZztcblxuICAgICAgICAgIC8vIEhldXJpc3RpYyBmYWxsYmFjayB0cmlnZ2VycyBpZiBtb2RlbCBzcGVha3MgaW50ZW50IGJ1dCBkaWRuJ3QgZW1pdCBhIGZ1bmN0aW9uLWNhbGxcbiAgICAgICAgICBpZiAobG93ZXIuaW5jbHVkZXMoJ2NhbGwgdGhlIGRpc3BhdGNoZXInKSB8fCBsb3dlci5pbmNsdWRlcygnY2FsbGluZyB0aGUgZGlzcGF0Y2hlcicpIHx8IGxvd2VyLmluY2x1ZGVzKCdjYWxsaW5nIHBvbGljZScpIHx8IGxvd2VyLmluY2x1ZGVzKCdjYWxsaW5nIDkxMScpKSB7XG4gICAgICAgICAgICBpZiAoIXdhc1RyaWdnZXJlZChjYWxsSWQsICdjYWxsX2RlbW9fcG9saWNlJykpIHtcbiAgICAgICAgICAgICAgY29uc3Qgc2NyaXB0ID0gJ1RoaXMgaXMgU3RhY3ksIGFuIEFJIHNhZmV0eSBhc3Npc3RhbnQuIFRoZSBjYWxsZXIgcmVxdWVzdGVkIGEgY29ubmVjdGlvbiB0byB0aGUgZGlzcGF0Y2hlci4gVGhpcyBpcyBhIGRlbW8gY2FsbC4nO1xuICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsRGVtb1BvbGljZShzY3JpcHQgKyAobGF0ICYmIGxuZyA/IGAgTG9jYXRpb24gY29vcmRpbmF0ZXMgJHtsYXR9LCAke2xuZ30uYCA6ICcnKSk7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5qUIEhldXJpc3RpYyBkaXNwYXRjaGVyIGNhbGwgcmVzdWx0OicsIHJlc3VsdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGxvd2VyLmluY2x1ZGVzKCd0ZXh0JykgJiYgKGxvd2VyLmluY2x1ZGVzKCdjb250YWN0JykgfHwgbG93ZXIuaW5jbHVkZXMoJ2VtZXJnZW5jeSBjb250YWN0JykgfHwgbG93ZXIuaW5jbHVkZXMoJ25vdGlmeScpKSkge1xuICAgICAgICAgICAgaWYgKCF3YXNUcmlnZ2VyZWQoY2FsbElkLCAnc2VuZF9jb250YWN0X3NtcycpKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHRvUGhvbmUgPSBwcm9jZXNzLmVudi5ERU1PX0VNRVJHRU5DWV9DT05UQUNUIHx8ICcrMTUxNDY2MDU3MDcnO1xuICAgICAgICAgICAgICBjb25zdCBtc2cgPSAnQXV0b21hdGVkIHNhZmV0eSBhbGVydCBmcm9tIFN0YWN5IEFJLiBUaGUgdXNlciByZXF1ZXN0ZWQgYXNzaXN0YW5jZS4nICsgKGxhdCAmJiBsbmcgPyBgXFxuXFxuTG9jYXRpb246IGh0dHBzOi8vbWFwcy5nb29nbGUuY29tL21hcHM/cT0ke2xhdH0sJHtsbmd9YCA6ICcnKTtcbiAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VuZFNtcyh0b1Bob25lLCBtc2cpO1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygn8J+TsSBIZXVyaXN0aWMgU01TIHJlc3VsdDonLCByZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKCdDb252ZXJzYXRpb24tdXBkYXRlIGhldXJpc3RpYyBmYWlsZWQ6JywgZXJyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzLmpzb24oeyByZWNlaXZlZDogdHJ1ZSB9KTtcbiAgICAgICAgXG4gICAgICBjYXNlICdoYW5nJzpcbiAgICAgICAgY29uc29sZS5sb2coJ/Cfk54gQ2FsbCBlbmRlZCcpO1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oeyByZWNlaXZlZDogdHJ1ZSB9KTtcbiAgICAgICAgXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBjb25zb2xlLmxvZygn4oS577iPIE90aGVyIG1lc3NhZ2UgdHlwZTonLCBtZXNzYWdlPy50eXBlKTtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKHsgcmVjZWl2ZWQ6IHRydWUgfSk7XG4gICAgfVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignVkFQSSB3ZWJob29rIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yIG9jY3VycmVkJyBcbiAgICB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbInNlbmRTbXMiLCJwaG9uZSIsIm1lc3NhZ2UiLCJhY2NvdW50U2lkIiwicHJvY2VzcyIsImVudiIsIlRXSUxJT19BQ0NPVU5UX1NJRCIsImF1dGhUb2tlbiIsIlRXSUxJT19BVVRIX1RPS0VOIiwiZnJvbU51bWJlciIsIlRXSUxJT19OVU1CRVIiLCJzdWNjZXNzIiwiZXJyb3IiLCJiYXNpYyIsIkJ1ZmZlciIsImZyb20iLCJ0b1N0cmluZyIsImJvZHkiLCJVUkxTZWFyY2hQYXJhbXMiLCJGcm9tIiwiVG8iLCJCb2R5IiwicmVzcCIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJkYXRhIiwianNvbiIsIm9rIiwic2lkIiwiZSIsImNhbGxEZW1vUG9saWNlIiwic2NyaXB0IiwidG9OdW1iZXIiLCJERU1PX0VNRVJHRU5DWV9OVU1CRVIiLCJERU1PX1BPTElDRV9OVU1CRVIiLCJ0d2ltbCIsIlR3aW1sIiwidHJpZ2dlcmVkQnlDYWxsSWQiLCJNYXAiLCJ3YXNUcmlnZ2VyZWQiLCJjYWxsSWQiLCJhY3Rpb24iLCJzZXQiLCJnZXQiLCJTZXQiLCJoYWQiLCJoYXMiLCJhZGQiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwic3RhdHVzIiwiY29uc29sZSIsImxvZyIsInR5cGUiLCJmdW5jdGlvbkNhbGwiLCJuYW1lIiwicGFyYW1ldGVycyIsImxhdCIsImxuZyIsInVyZ2VudCIsImRlZmF1bHRDb250YWN0IiwiREVNT19FTUVSR0VOQ1lfQ09OVEFDVCIsInRvUGhvbmUiLCJ0ZXh0IiwicmVzdWx0IiwiZnVsbCIsImxvY2F0aW9ucyIsImRpc3RhbmNlX20iLCJlcnIiLCJjYWxsIiwiaWQiLCJtZXNzYWdlcyIsImNvbnZlcnNhdGlvbiIsImxhc3QiLCJsZW5ndGgiLCJjb250ZW50IiwibG93ZXIiLCJ0b0xvd2VyQ2FzZSIsIm1ldGFMb2NhdGlvbiIsImFzc2lzdGFudCIsIm1ldGFkYXRhIiwibG9jYXRpb24iLCJpbmNsdWRlcyIsIm1zZyIsIndhcm4iLCJyZWNlaXZlZCIsIkVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/vapi/webhook.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fvapi%2Fwebhook&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fvapi%2Fwebhook.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();